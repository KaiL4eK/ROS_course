# Основы работы в Shell

- [Чуть поговорим о файловой системе в Linux](#чуть-поговорим-о-файловой-системе-в-linux)
- [Основные команды работы с файлами](#основные-команды-работы-с-файлами)
  - [ls](#ls)
  - [mkdir](#mkdir)
  - [cd](#cd)
  - [Больше о перемещении - relative vs absolute](#больше-о-перемещении---relative-vs-absolute)
  - [А как двигаться назад (наверх)?](#а-как-двигаться-назад-наверх)
  - [mv](#mv)
  - [nano](#nano)
- [Скрипты shell](#скрипты-shell)
- [Переменные окружения](#переменные-окружения)
- [Сессия терминала](#сессия-терминала)
- [Импорт переменных из скрипта](#импорт-переменных-из-скрипта)
- [Команды для обработки вывода](#команды-для-обработки-вывода)
- [Ресурсы](#ресурсы)

Привет! В этой теме пройдемся по основным моментам, которые нужно знать, чтобы безболезненно пользоваться [командной оболочкой](https://ru.wikipedia.org/wiki/%D0%9A%D0%BE%D0%BC%D0%B0%D0%BD%D0%B4%D0%BD%D0%B0%D1%8F_%D0%BE%D0%B1%D0%BE%D0%BB%D0%BE%D1%87%D0%BA%D0%B0_Unix) Shell (Bourne Shell).

Вообще, в Ubuntu оболочка по-умолчанию - Bash (Bourne again shell). Существует и куча других оболочек, например, zsh, fish, xsh и другие. Главная суть в том, что все они реализуют набор команд, с помощью которых можно управлять операционной системой.

> Важно, [POSIX-совместимых](https://ru.wikipedia.org/wiki/POSIX) команд - это стандарт такой =)

На самом деле, когда в файловом менеджере мы перетаскиваем мышкой папку или файлы, удаляем - делаем действия с помощью графического интерфейса (GUI - Graphical User Interface), внутри этих действий исполняются те или иные команды CLI (Command Line Interface).

> Не всегда напрямую те, что мы разберем, но логика такова, что вся графика - это надстройка над рядом базовых действий, которые можно сделать командами в Shell.

Поэтому, сегодня наша **цель** - разобраться как работать с командной строкой!

Поехали, открваем терминал (находим в меню приложений **Terminal**) и видим это:

<p align="center">
<img src=../assets/0_01_shell_first_screen.png />
</p>

> У тебя может быть другое название зелеными буквами и название терминала =)

Это и есть терминал, в котором мы будем вводить наши команды. Давайте начнем наше знакомство с первой команды:

```bash
pwd
```

> `pwd` - команда вывода директории, в которой находимся сейчас

В результате увидите `/home/user` вывод.

## Чуть поговорим о файловой системе в Linux

Давай подробнее рассмотрим, почему путь выглядит именно так и что это за символы '/'?

Вся файловая система в Linux устроена в виде дерева. Вот, взгляните:

<p align="center">
<img src=../assets/0_01_linux_filesystem.png />
</p>

> Подробнее про каждую директорию кратко расписано [здесь](https://computingforgeeks.com/understanding-the-linux-file-system-hierarchy/)

По сути, путь в виде строки '/' - это путь до корня файловой системе. В корне лежат все остальные папки, а в них лежат другие подпапки.

Так как нам интерпретировать путь `/home/user`? В корне лежит директория `home`, внутри которой есть директория `user`, внутри которой мы и находимся.

На самом деле в Windows используются такие же пути, но там вместо корня диски (`C:\\`, `D:\\` и т.д.), а папки разделяет символ `\`.

## Основные команды работы с файлами

Теперь, когда мы знаем, как вывести директорию, в которой мы находимся и понимаем, как устроены папки и файлы в Linux, пора научиться ими управлять!

### ls

Самая первая команда, которой стоит научиться - это команда вывода файлов и директорий в конкретной папке. Для этого используем `ls`:

```bash
ls
# Вывод: Downloads Pictures и т.д.
```

> В зависимости от языка названия папок могут меняться в системе.

Отлично, но что если мне хочется больше информации о папках и директориях? Вот тут мы встречаемся с **опциями команд**! Опции - это расширения команд, которые позволяют задать желаемое поведение (изменить под себя). Ведь удобно вывести просто список директорий и папок, но что если нужно больше информации? Используем опцию `-l`!

```bash
ls -l
```

и видим

```bash
total 40
drwxr-xr-x 15 user user  4096 Aug  6 23:56 Downloads
...
```

Вооу, сколько информации. Тут и дата последнего редактирования, и пользователь, владеющий файлами и папками и много другого, но мы пока сконцентрируемся на том, что это крутая опция!

> У большинства команд есть опция `-h` или длинная опция `--help`, которая выводит информацию по всем возможным настройкам утилиты.

:muscle: Выведи помощь к команде `ls` и прочитай, какие еще есть опции у нее

### mkdir

Хорошо, выводить информацию полезно, но еще полезнее научиться управлять файлами и папками. Следующая команда `mkdir` (make directory) - позволит создавать директории.

:muscle: Создай папку, введя `mkdir super_dir` или другое имя вместо "super_dir" в качестве **аргумента** команды. Проверь в `ls` и файловом менеджере, что папка создана.

> Аргумент - дополнительная информация, которая передается после команды. Опция отличается наличием символа "-".

Вы смогли сами создать папку? Крууутооо! Погнали внутрь!

### cd

Так, мы папку создали и даже может зайти в нее в файловом менеджере, но как нам передвигаться в терминале? Все просто! Для этого есть команда `cd` (change directory). 

:muscle: Перейди в директорию командой `cd super_dir`. Выведи с помощью `pwd` нынешний путь и проверь, что переход удачен.

:muscle: А теперь вопрос на подумать, почему, после первого выполнения перехода в "super_dir" второй уже не работает? А если открыть терминал заново, то снова, один раз работает, а другой раз нет?

Так, ну мы освоили способ перемещения, но ведь все подкрепляется практикой, пока создать целую структуру:

:muscle: Создай следующую структуру папок и проверьте себя в файловом менеджере. Убедитесь, что вы можете перемещаться по всем этим директориям без проблем.
  - super_dir
    - fruits
      - apple
      - orange
      - pear
    - vegetables
      - lettuce
      - onion
      - cucumber
      - spinach

### Больше о перемещении - relative vs absolute

Обратим внимание, что два раза команду не выполнить, так как при переходе в папку "super_dir" мы уже находимся в ней. То есть, команда `cd super_dir` - это переход в директорию из нынешней директории. Если внутри "super_dir" нет второй с тем же именем, то и команда несколько раз работать не будет.

Думаю понятно, что как в случае `mkdir`, так и в случае `cd` требуется аргумент, которым является имя для создания/перехода. Этим аргументом у нас являлась директория "super_dir" - работа с директорией из нынешней папки.

Так мы познакомились с относительным путем:

> Относительный (Relative) путь - путь в файловой системе от нынешнего положения. Может быть `super_dir` или `./super_dir`. "." - это символ, который при использовании в пути заменяет на путь "отсюда".

Короче, если хотим создавать и делать что-то из нынешней директории, то пользуемся **относительными** путями.

А что если теперь выполнить команду `cd /home/user/super_dir` (обрати внимание, у тебя вместо `user` в `pwd` могло быть другое имя пользователя)? Попробуй! Несколько раз подряд? :muscle:

Интересно, а такая команда выполняется, почему?

Все просто, при задании таким способом мы задаем **абсолютный** путь в файловой системе:

> Абсолютный (Absolute) путь - путь в файловой системе от "/" (корня).

Абсолютным путем не всегда удобно пользоваться, но в некоторых ситуациях он полезен, поэтому мотаем на ус.

### А как двигаться назад (наверх)?

Если так подумать, то после создания нашей базы знаний фруктов и овощей (задачка про папки с fruits/vegetables) мы умеет только двигаться вперед с помощью `cd` и относительного пути.

После изучения абсолютного пути, мы может вернуться в корень нашей базы (`cd /home/user/super_dir`) и снова двигаться вглубь. Но что если я хочу из папки `orange` вернуться в папку `fruits`?

> Да можно сделать `cd /home/user/super_dir/fruits`, но смотри дальше, там будет фокус с точками!

Что, если я скажу, что "." - это нынешняя директория (можешь даже попробовать `cd .` =)), а директория выше по дереву - это, погоди-погоди, две точки!

Да, именно ".." определяет путь до папки выше по дереву. (В некоторых интерпретаторах "..." - это подъем на два уровня выше).

Итого, если тебе нужно передвинуться из `apple` папки в папку `fruits` - просто делаешь `cd ..` и вот, цель достигнута!

:muscle: Ну все, теперь ты умеешь просто професионально двигаться в команднйо строке! Погнали, зайди в каждую папку, выйди из нее и переместись в следующую! Время путешествий!

### mv

Так, мы подошли в моменту, когда в нашей базе мы не хотим иметь лук (onion), не нравится он нам, а поменяем его на тыкву!

Синтаксис команды для переименования папок и файлов:

```bash
mv <оригинальное имя> <новое имя>
```

Например, `mv super_dir new_super_dir` переименует нашу базовую директорию. Делать это не обязательно, пойдем сразу практиковаться!

:muscle: Переименуйте лук в тыкву (pimpkin). Также, переименуйте любой фрукт в любой другой фрукт.

Такс такс, базу мы подредактировали, молодцы!

### nano

Папки это хорошо, но мы не за тем учимся терминалу, чтобы просто создавать папки! Сейчас мы очень быстро научимся создавать и редактировать текстовые файлы!

> А с учетом того, что исходники - это текстовые файлы, то это очень полезный навык!

Переходим в директорию "super_dir" (это сами) и создаем там текстовый файл с описанием нашей базы фруктов и овощей:

```bash
nano description.txt
```

Откроется редактор нового файла:

<p align="center">
<img src=../assets/0_01_nano_editor.png />
</p>

Работать в нем просто, двигаете курсор с помощью стрелок указателей и набираете текст.

Чтобы выйти, нам помогает подсказка "^X Exit". Символ "^" означает клавишу "Ctrl", так что для выхода нажимаете "Ctrl+X".

Но перед этим надо сохранить файл, "^O Write Out", то есть, "Ctrl+O".

Если не сохранить, но выйти - нам напомнят о том, что файл не сохранен! Удобно!

> В nano еще куча разных hotkey комбинаций, например, вырезать всю строку, поиск в файле и т.д. Больше инфы найдете [здесь](https://www.nano-editor.org/dist/latest/cheatsheet.html)!

Обычно в практике nano не используется постоянно, но это удобно, если нужно быстро подредактировать/посмотреть какой-то файл, а в редакторе типа VSCode отдельно открывать долго.

## Скрипты shell

## Переменные окружения

## Сессия терминала

## Импорт переменных из скрипта

## Команды для обработки вывода

## Ресурсы

- [Хороший справочки по Bash](https://ss64.com/bash/)

